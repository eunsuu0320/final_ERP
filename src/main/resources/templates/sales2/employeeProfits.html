<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
      xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
      layout:decorate="~{layout/main}">

<head>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<link href="https://unpkg.com/tabulator-tables@5.5.2/dist/css/tabulator.min.css" rel="stylesheet">
<meta name="_csrf" th:content="${_csrf.token}" />
<meta name="_csrf_header" th:content="${_csrf.headerName}" />

<style>
.container-fluid { padding: 20px 40px; }

.view-buttons {
  display: flex;
  gap: 10px;
  margin-bottom: 15px;
}

.view-btn {
  border: 1px solid #ccc;
  background-color: #f8f9fa;
  padding: 6px 16px;
  border-radius: 6px;
  cursor: pointer;
  font-weight: 600;
}

.view-btn.active {
  background-color: #198754;
  color: white;
  border-color: #198754;
}

.filter-bar {
  display: flex;
  align-items: center;
  gap: 10px;
  margin-bottom: 25px;
}

.filter-bar select,
.filter-bar input {
  height: 36px;
  padding: 0 8px;
  border-radius: 4px;
  border: 1px solid #ccc;
}

.filter-bar button {
  background-color: #ff914d;
  color: white;
  border: none;
  border-radius: 4px;
  padding: 6px 12px;
}

.summary-box {
  border: 2px solid #dee2e6;
  border-radius: 10px;
  padding: 20px 10px;
  background-color: #fafafa;
  margin-bottom: 30px;
}

.summary-item {
  font-weight: 600;
  color: #333;
  text-align: center;
}
</style>
</head>

<body layout:fragment="content">
<div id="layoutSidenav_content">
  <main>
    <div class="container-fluid px-4">
      <h1 class="mt-4 mb-4">ì˜ì—…ì´ìµê´€ë¦¬</h1>

      <!-- âœ… ë³´ê¸° íƒ­ -->
      <div class="view-buttons">
        <button class="view-btn" id="btnProductView">í’ˆëª©ë³„</button>
        <button class="view-btn active" id="btnEmployeeView">ì‚¬ì›ë³„</button>
      </div>

      <!-- âœ… í•„í„° ì˜ì—­ -->
      <div class="filter-bar">
        <label>ë…„ë„ :</label>
        <select id="yearSelect"></select>

        <label>ë¶„ê¸° :</label>
        <select id="quarterSelect">
          <option value="">ì „ì²´</option>
          <option value="1">1ë¶„ê¸°</option>
          <option value="2">2ë¶„ê¸°</option>
          <option value="3">3ë¶„ê¸°</option>
          <option value="4">4ë¶„ê¸°</option>
        </select>

        <!-- ğŸ” ì‚¬ì› ê²€ìƒ‰ -->
        <label>ê²€ìƒ‰(ì‚¬ì›ëª…):</label>
        <div style="position: relative; display: inline-block;">
          <input id="searchInput" type="text" placeholder="ì‚¬ì›ëª… ì…ë ¥" style="width:180px; padding-right:30px;">
          <i class="fas fa-search"
             style="position: absolute; right: 8px; top: 50%; transform: translateY(-50%); color: #888; cursor: pointer;"
             id="searchIcon"></i>
        </div>

        <button id="btn-search" type="button">ê²€ìƒ‰</button>
      </div>

      <!-- âœ… ìš”ì•½ ë°•ìŠ¤ -->
      <h3 class="mt-4 mb-4">ìš”ì•½</h3>
      <div class="summary-box">
        <div class="row text-center">
          <div class="col summary-item">
            ì´ íŒë§¤ìˆ˜ëŸ‰<br>
            <span id="totalSalesCount" class="text-primary fs-5 fw-bold">0</span>
          </div>
          <div class="col summary-item">
            ì´ ê³µê¸‰ê°€ì•¡<br>
            <span id="totalSupply" class="text-primary fs-5 fw-bold">0</span>
          </div>
          <div class="col summary-item">
            ì´ ë¶€ê°€ì„¸<br>
            <span id="totalTax" class="text-primary fs-5 fw-bold">0</span>
          </div>
          <div class="col summary-item">
            ì´ í•©ê³„ê¸ˆì•¡<br>
            <span id="totalAmount" class="text-primary fs-5 fw-bold">0</span>
          </div>
        </div>
      </div>

      <!-- âœ… ì‚¬ì›ë³„ ì‹¤ì  ì¡°íšŒ í…Œì´ë¸” -->
      <h3 class="mt-4 mb-4">ì‚¬ì›ë³„ ì‹¤ì  ì¡°íšŒ</h3>
      <div id="sales-table"></div>
    </div>
    
    <!-- âœ… ì‚¬ì› ìƒì„¸ ëª¨ë‹¬ -->
<div class="modal fade" id="employeeModal" tabindex="-1" aria-labelledby="employeeModalLabel" aria-hidden="true">
  <div class="modal-dialog modal-xl modal-dialog-centered">
    <div class="modal-content">
      <div class="modal-header bg-primary text-white">
        <h5 class="modal-title" id="employeeModalLabel">ì‚¬ì›ë³„ íŒë§¤ëª©ë¡</h5>
        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="modal" aria-label="ë‹«ê¸°"></button>
      </div>

      <div class="modal-body">
        <!-- âœ… ê²€ìƒ‰ ì˜ì—­ -->
        <div class="d-flex align-items-center mb-3">
          <label class="fw-bold me-2">ê±°ë˜ì²˜ëª…:</label>
          <div style="position: relative; display: inline-block;">
            <input id="modal-searchInput" type="text" placeholder="ê±°ë˜ì²˜ëª… ì…ë ¥" style="width:180px; padding-right:30px;">
            <i class="fas fa-search"
              id="modal-searchIcon"
              style="position: absolute; right: 8px; top: 50%; transform: translateY(-50%); color: #888; cursor: pointer;"></i>
          </div>
          <button id="modal-btn-search" class="btn btn-warning btn-sm ms-2">ê²€ìƒ‰</button>
        </div>

        <!-- âœ… íŒë§¤ í…Œì´ë¸” -->
        <div id="employee-sales-table"></div>
      </div>

      <div class="modal-footer">
        <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ë‹«ê¸°</button>
      </div>
    </div>
  </div>
</div>
    
  </main>
</div>

<script src="https://unpkg.com/tabulator-tables@5.5.2/dist/js/tabulator.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>
<script th:src="@{/sales2/js/employeeProfits.js}"></script>
</body>
</html>
