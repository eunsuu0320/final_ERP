<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/main}">

<head>
<!-- ‚úÖ FontAwesome & Tabulator -->
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
<link href="https://unpkg.com/tabulator-tables@5.5.2/dist/css/tabulator.min.css" rel="stylesheet">

<meta name="_csrf" th:content="${_csrf.token}" />
<meta name="_csrf_header" th:content="${_csrf.headerName}" />

<style>
.custom-modal {
  max-width: 1200px;
}

.modal-body {
  padding: 30px 40px;
}

.custom-modal .modal-content {
  height: 85vh;
}
</style>

</head>

<body layout:fragment="content">
<div id="layoutSidenav_content">
	<main>
       <div class="container-fluid px-4">
           <h1 class="mt-4">ÏàòÍ∏àÍ¥ÄÎ¶¨</h1>

           <!-- üîç Í≤ÄÏÉâ + Î≤ÑÌäº ÏòÅÏó≠ -->
           <div class="d-flex align-items-center justify-content-between mb-3 mt-3">

                <!-- üîé Í±∞ÎûòÏ≤ò Í≤ÄÏÉâ -->
                <div class="input-group" style="width:350px;">
                    <span class="input-group-text">Í±∞ÎûòÏ≤ò Í≤ÄÏÉâ</span>
                    <input id="partner" type="text" class="form-control" placeholder="Í±∞ÎûòÏ≤òÎ™Ö ÏûÖÎ†•">
                    <input type="hidden" id="partnerCode" name="partnerCode">

                    <i class="fas fa-search"
                       style="position: absolute; right: 70px; top: 50%; transform: translateY(-50%); cursor: pointer;"
                       onclick="openModal('partner', function(selected) {
                           document.getElementById('partnerCode').value = selected.No;
                           document.getElementById('partnerName').value = selected.name;
                       })"></i>
                    <button id="btn-search" class="btn btn-warning" type="button">Í≤ÄÏÉâ</button>
                </div>

                <!-- üìå Î≤ÑÌäº Í∑∏Î£π -->
                <div class="d-flex gap-2">
                    <button id="btn-new" class="btn btn-primary">Ïã†Í∑ú</button>
                    <button id="btn-excel" class="btn btn-secondary">Excel</button>
                    <button id="btn-pdf" class="btn btn-secondary">PDF</button>
                </div>
           </div>

           <!-- üìã Î©îÏù∏ Tabulator ÌÖåÏù¥Î∏î -->
           <div id="sales-table"></div>

           <!-- Ï¥ù Í±∞ÎûòÏ≤ò Ïàò -->
           <div id="total-count" class="mt-2 fw-bold">
               Ï¥ù Í±∞ÎûòÏ≤ò: <span class="text-primary">0Í±¥</span>
           </div>

           <!-- üí∞ ÏàòÍ∏à Îì±Î°ù Î™®Îã¨ -->
           <div class="modal fade" id="insertCollectionModal" tabindex="-1" aria-labelledby="insertCollectionModalLabel" aria-hidden="true">
             <div class="modal-dialog modal-xxl custom-modal">
                <div class="modal-content">



                  <!-- Header -->
                  <div class="modal-header">
                    <h5 class="modal-title" id="insertCollectionModalLabel">ÏàòÍ∏à Îì±Î°ù</h5>
                    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
                  </div>

                  <!-- Body -->
                  <div class="modal-body">
                    <form id="collectionForm">
                      <div class="container-fluid">

                        <!-- ÏÉÅÎã® Î≤ÑÌäº -->
                        <div class="d-flex justify-content-end mb-3">
                          <button type="button" id="btn-searchInvoice" class="btn btn-outline-secondary me-2">Ï≤≠Íµ¨ÏÑú Ï°∞Ìöå</button>
                          <button type="button" id="btn-saveCollection" class="btn btn-primary">Ï†ÄÏû•</button>
                        </div>

                        <!-- Í∏∞Î≥∏Ï†ïÎ≥¥ ÏòÅÏó≠ -->
                        <div class="row mb-3">
                          <div class="col-md-3">
                            <label class="form-label">ÏàòÍ∏àÏùºÏûê</label>
                            <div class="d-flex align-items-center">
                              <select id="year" class="form-select me-1">
                                <option>2025</option><option>2024</option>
                              </select>
                              <select id="month" class="form-select me-1">
                                <option>01</option><option>02</option><option>03</option><option>04</option><option>05</option>
                              </select>
                              <select id="day" class="form-select me-1">
                                <option>01</option><option>02</option><option>03</option><option>04</option><option>05</option>
                              </select>
                              <i class="fa-regular fa-calendar ms-2"></i>
                            </div>
                          </div>

                          <div class="col-md-3">
                            <label class="form-label">Í±∞ÎûòÏ≤ò</label>
                            <input type="text" id="partnerName" class="form-control" placeholder="Í±∞ÎûòÏ≤òÎ™Ö ÏûÖÎ†•">
                          </div>

                          <div class="col-md-3">
                            <label class="form-label">Îã¥ÎãπÏûê</label>
                            <input type="text" id="manager" class="form-control" placeholder="Îã¥ÎãπÏûêÎ™Ö ÏûÖÎ†•">
                          </div>

                          <div class="col-md-3">
                            <label class="form-label">Í≤∞Ï†úÏ†ïÎ≥¥</label>
                            <div class="input-group">
                              <input type="text" id="paymentInfo" class="form-control" placeholder="Í≤∞Ï†ú Î∞©Ïãù ÏûÖÎ†•">
                              <button class="btn btn-outline-secondary" type="button" id="btn-searchPayment">
                                <i class="fa-solid fa-magnifying-glass"></i>
                              </button>
                            </div>
                          </div>
                        </div>

                        <!-- Ï≤≠Íµ¨ÎÇ¥Ïó≠ ÌÖåÏù¥Î∏î -->
                        <h6 class="mt-4">Ï≤≠Íµ¨ÎÇ¥Ïó≠</h6>
                        <div id="invoiceTable"></div>

                      </div>
                    </form>
                  </div>
                  
                </div>
              </div>
           </div>
       </div>
    </main>
</div>

<!-- ‚úÖ Í≥µÌÜµ Î™®Îã¨ -->
<div th:replace="common/modal :: commonModal"></div>

<!-- ‚úÖ Tabulator JS -->
<script src="https://unpkg.com/tabulator-tables@5.5.2/dist/js/tabulator.min.js"></script>

<!-- ‚úÖ Bootstrap (Î™®Îã¨ ÌïÑÏàò) -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<!-- ‚úÖ Í∏∞Ï°¥ JS -->
<script th:src="@{/sales2/js/collection.js}"></script>
</body>
</html>


