<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org"
	xmlns:layout="http://www.ultraq.net.nz/thymeleaf/layout"
	layout:decorate="~{layout/main}">

<head>
  <!-- âœ… FontAwesome & Tabulator -->
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css">
  <link href="https://unpkg.com/tabulator-tables@5.5.2/dist/css/tabulator.min.css" rel="stylesheet">

  <meta name="_csrf" th:content="${_csrf.token}" />
  <meta name="_csrf_header" th:content="${_csrf.headerName}" />

  <style>
    .custom-modal {
      max-width: 900px;
    }
    .modal-body {
      padding: 30px 40px;
    }
    .modal-content {
      border-radius: 12px;
      box-shadow: 0 4px 20px rgba(0, 0, 0, 0.15);
    }
    #resultTable {
      margin-top: 20px;
    }
    .tabulator-header {
      background: #f8f9fa;
    }
  </style>
</head>

<body layout:fragment="content">
<div id="layoutSidenav_content">
	<main>
    <div class="container-fluid px-4">
      <h1 class="mt-4">ìˆ˜ê¸ˆê´€ë¦¬</h1>

      <!-- ğŸ” ê²€ìƒ‰ + ë²„íŠ¼ ì˜ì—­ -->
      <div class="d-flex align-items-center justify-content-between mb-3 mt-3">

        <!-- ğŸ” ê±°ë˜ì²˜ ê²€ìƒ‰ -->
        <div class="input-group" style="width:350px;">
          <span class="input-group-text">ê±°ë˜ì²˜ ê²€ìƒ‰</span>
          <input id="partnerName" type="text" class="form-control" placeholder="ê±°ë˜ì²˜ëª… ì…ë ¥">
          <input type="hidden" id="partnerCode" name="partnerCode">
          <i class="fas fa-search"
             style="position: absolute; right: 70px; top: 50%; transform: translateY(-50%); cursor: pointer;"
             onclick="openModal('partner', function(selected) {
               document.getElementById('partnerCode').value = selected.partnerCode;
               document.getElementById('partnerName').value = selected.partnerName;
             })"></i>
          <button id="btn-search" class="btn btn-warning" type="button">ê²€ìƒ‰</button>
        </div>

        <!-- ğŸ“Œ ë²„íŠ¼ ê·¸ë£¹ -->
        <div class="d-flex gap-2">
          <button id="btn-excel" class="btn btn-secondary">Excel</button>
          <button id="btn-pdf" class="btn btn-secondary">PDF</button>
        </div>
      </div>

      <!-- ğŸ“‹ ë©”ì¸ Tabulator í…Œì´ë¸” -->
      <div id="sales-table"></div>

      <div id="total-count" class="mt-2 fw-bold">
        ì´ ê±°ë˜ì²˜: <span class="text-primary">0ê±´</span>
      </div>

      <!-- ğŸ’° ìˆ˜ê¸ˆ ë“±ë¡ ëª¨ë‹¬ -->
      <div class="modal fade" id="insertCollectionModal" tabindex="-1" aria-labelledby="insertCollectionModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-lg modal-dialog-centered custom-modal">
          <div class="modal-content">

            <div class="modal-header d-flex justify-content-between align-items-center">
			  <h5 class="modal-title fw-bold" id="insertCollectionModalLabel">ìˆ˜ê¸ˆ ë“±ë¡</h5>
			  
			  <div class="d-flex align-items-center gap-2">
			    <button id="btnSave" class="btn btn-primary">ìˆ˜ê¸ˆë“±ë¡</button>
			    <button id="btnView" class="btn btn-secondary">ë¯¸ìˆ˜ë‚´ì—­ ì¡°íšŒ</button>
			    <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
			  </div>
			</div>

            
            <div class="modal-body">
            <input type="hidden" id="outstandingAmt">
              <div class="row mb-3">
                <div class="col-md-4">
                  <label class="form-label">*ìˆ˜ê¸ˆì¼ì</label>
                  <input type="date" id="moneyDate" class="form-control" value="2025-10-10">
                </div>                
                <div class="col-md-4">
                  <label class="form-label">*ê±°ë˜ì²˜</label>
                  <input type="text" id="modalPartnerName" class="form-control" placeholder="ê±°ë˜ì²˜ëª… ì…ë ¥">
                </div>
                <div class="col-md-4">
                  <label class="form-label">*ë‹´ë‹¹ì</label>
                  <input type="text" id="managerName" class="form-control" placeholder="ë‹´ë‹¹ìëª… ì…ë ¥">
                </div>
              </div>

              <div class="row mb-3">
                <div class="col-md-4">
                  <label class="form-label">*ìˆ˜ê¸ˆê¸ˆì•¡</label>
                  <input type="text" id="collectAmt" class="form-control" placeholder="ê¸ˆì•¡ ì…ë ¥">
                </div>
                <div class="col-md-4">
                  <label class="form-label">*ê²°ì œë°©ì‹</label>
                  <select id="paymentType" class="form-select">
                    <option value="">ì„ íƒ</option>
                    <option value="í˜„ê¸ˆ">í˜„ê¸ˆ</option>
                    <option value="ê³„ì¢Œì´ì²´">ê³„ì¢Œì´ì²´</option>
                    <option value="ì¹´ë“œ">ì¹´ë“œ</option>
                  </select>
                </div>
                <div class="col-md-4">
                  <label class="form-label">ë¹„ê³ </label>
                  <input type="text" id="remarks" class="form-control" placeholder="ë¹„ê³  ì…ë ¥">
                  <input type="hidden" id="partnerCode" name="partnerCode">
                </div>
              </div>

              <!-- ğŸ“Š ìˆ˜ê¸ˆ ì²˜ë¦¬ ê²°ê³¼ Tabulator -->
              <h6 class="fw-bold mb-2">ìˆ˜ê¸ˆ ì²˜ë¦¬ ê²°ê³¼</h6>
              <div id="resultTable"></div>

            </div>
          </div>
        </div>
      </div>

    </div>
  </main>
</div>

<!-- âœ… ê³µí†µ ëª¨ë‹¬ -->
<div th:replace="common/modal :: commonModal"></div>

<!-- âœ… Tabulator JS -->
<script src="https://unpkg.com/tabulator-tables@5.5.2/dist/js/tabulator.min.js"></script>

<!-- âœ… Bootstrap -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js"></script>

<!-- âœ… ë³„ë„ JS íŒŒì¼ -->
<script th:src="@{/sales2/js/collection.js}"></script>

</body>
</html>

